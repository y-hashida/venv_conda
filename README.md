# Anaconda venv

## 1. 目次

<!-- TOC depthFrom:2 -->

- [1. 目次](#1-目次)
- [2. 特徴](#2-特徴)
- [3. 動作環境](#3-動作環境)
- [4. インストール (デフォルト)](#4-インストール-デフォルト)
- [5. インストール (パッケージを追加する)](#5-インストール-パッケージを追加する)
    - [5.1. 説明](#51-説明)
    - [5.2. ディレクトリ構造](#52-ディレクトリ構造)
    - [5.3. 追加する req.yml の例](#53-追加する-reqyml-の例)
- [6. 使い方](#6-使い方)
    - [6.1. ラッパースクリプトを使う](#61-ラッパースクリプトを使う)
    - [6.2. アクティベートして使う](#62-アクティベートして使う)
- [7. venv をリセット](#7-venv-をリセット)
- [8. Licence](#8-licence)

<!-- /TOC -->

<br>

## 2. 特徴

- anaconda の仮想環境 (venv) とラッパースクリプトを提供します(`conda`, `python3`, `pip`, etc...).
- バージョンを固定してインストールできます (`req.yml`).
- venv はお使いのマシンの python 環境を汚さないように設計しています (`_venvs` ディレクトリ).
- venv は気軽にリセットできます (`clean_venvs.sh`).
- 主にサブモジュールとして使われることを期待して開発しています.

<br>

## 3. 動作環境

- Linux
- WSL2 (多分)

※ macOS はまだ対応できていない. 
※ 純粋な Windows 版は対応予定はない.

<br>

## 4. インストール (デフォルト)

開発中のプロジェクトのリポジトリ上にて以下のように実行します.

初回は実行時は `_venvs` 以下にインストールが始まります.
2回目以降はすぐに実行されます.

```
## インストール
git submodule add https://github.com/y-hashida/venv_conda.git conda

## 動作確認
./conda/conda --version
./conda/python --version
```

<br>

## 5. インストール (パッケージを追加する)

### 5.1. 説明

デフォルトだと `_scripts` 以下の `req.yml` にあるパッケージのみインストールしますが, プロジェクトによっては他のパッケージもインストールしたいケースがあります.
その場合, プロジェクトのリポジトリルートに `req.yml` を置いてそれに追記します.

<br>

### 5.2. ディレクトリ構造

```
project/
├── conda/...  # サブモジュールとして追加したこのリポジトリ
├── req.yml    # これを作成!!!
```

<br>

### 5.3. 追加する req.yml の例

```yaml
---
name: 'venv'
channels:
  - 'defaults'
dependencies:
  - 'passlib'
  - 'pip'    # pip でインストールする場合は conda の pip を使うことを明示的にする
  - pip: []  # こっちに pip のパッケージ名をリストで書く 
```

<br>

## 6. 使い方

### 6.1. ラッパースクリプトを使う

主流な使い方です.

あらかじめ用意してある以下のコマンドが使えます.

```
./conda/conda --version
./conda/python --version
./conda/pip --version
```

<br>

### 6.2. アクティベートして使う

venv をアクティベートして使う方法です.

パスも通すことができます.

```
source activate.sh
```

<br>

## 7. venv をリセット

作成している venv を一旦削除するには以下のように実行します.

```
./clean_venvs.sh
```

<br>

## 8. Licence
[MIT](./LICENSE.md)
